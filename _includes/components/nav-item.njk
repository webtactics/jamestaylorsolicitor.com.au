{% set isParent = entry.children.length > 0 %}
{% set childIsActive = entry.url == currentPageUrl or isParent and entry.children | map('url') | contains(currentPageUrl) %}

<a href="{{ entry.url }}" {% if childIsActive %} class="{% if entry.url == currentPageUrl %}active-class{% endif %}{% if isParent %} parent{% endif %}"{% endif %}>{{ entry.title }}</a>

{% if isParent and childIsActive %}
  <ul class="second-level">
    {% for child in entry.children %}
      <li>
        {% set childIsActive = child.url == currentPageUrl %}
        {% include '_includes/components/nav-item.njk' with { entry: child, currentPageUrl: currentPageUrl } %}
      </li>
    {% endfor %}
  </ul>
{% endif %}
